# Week-8-Pentesting-Live-Targets

# Project 8 - Pentesting Live Targets

Time spent: **10** hours spent in total

> Objective: Identify vulnerabilities in three different versions of the Globitek website: blue, green, and red.

The six possible exploits are:
* Username Enumeration
* Insecure Direct Object Reference (IDOR)
* SQL Injection (SQLi)
* Cross-Site Scripting (XSS)
* Cross-Site Request Forgery (CSRF)
* Session Hijacking/Fixation

Each version of the site has been given two of the six vulnerabilities. (In other words, all six of the exploits should be assignable to one of the sites.)

## Blue

Vulnerability #1: **SQL Injection**

```
3. SQL Injection: Most of the data input received by these websites is being sanitized properly. 
However, one of the three sites has one place where the input is not being sanitized before being 
used in an SQL query. Determine which color has the vulnerability.
```

<img
src='https://github.com/RobPiccirillo/Week-8-Pentesting-Live-Targets/blob/master/BlueSQLInjection.gif'
title='Video Walkthrough' width='' alt='Video Walkthrough' />


* SQL injection at the public/staff/salespeople/show.php?id=?? endpoint. I replaced the ?? with the following code: ' OR SLEEP(4)=0--' (which becomes %27%20OR%20SLEEP(4)%20=%200--%27 when encoded in a URL). This snippet forced the SQL query (and thus our entire request) to pause for 4 seconds, which indicates a successful injection.





Vulnerability #2: **Session Hijacking/Fixation**

```
6. Session Hijacking/Fixation: Two of the three websites expire their active sessions and 
require users to re-login every 30 minutes. That is probably too aggressive for the real world, 
but it is better than the third site which allows sessions to be a year old, and never regenerates 
the session ID, even when the user agent string changes. This makes it vulnerable to both session 
hijacking and session fixation attacks.
```

<img
src='https://github.com/RobPiccirillo/Week-8-Pentesting-Live-Targets/blob/master/BlueSessionHijacking.gif'
title='Video Walkthrough' width='' alt='Video Walkthrough' />


* Use two different web browsers or tabs. Let one tab be the attacker and the other the target. You can attempt a session hijacking or session fixation, all up to you. For hijacking, log the target in first, then give the logged-in session ID to the attacker. For fixation, get a session ID for the attacker, give it to the target, then the target will log in. In either case, the attacker now has access.


## Green

Vulnerability #1: **Username Enumeration**

```
1. Username Enumeration: A careless developer mistake has created a username enumeration 
vulnerability. Determine which color has the vulnerability. You can use the existing username 
"jmonroe99" as a test. Next, figure out what mistake the developer made.
```

<img
src='https://github.com/RobPiccirillo/Week-8-Pentesting-Live-Targets/blob/master/GreenUsernameEnumeration.gif'
title='Video Walkthrough' width='' alt='Video Walkthrough' />

* When using a username that doesn't exist and any password, the site's error message simply states "Log in was unsuccessful.". However, when using an existing username and an incorrect password, it shows the error message, but in bold "**Log in was unsuccessful.**".


Vulnerability #2: **Cross-Site Scripting**

```
4. Cross-Site Scripting: All three sites do a good job of protecting against a reflected 
XSS attack. However, one of the sites has a mistake which leaves the site vulnerable to 
a stored XSS attack. A reflected XSS attack would be easy to reveal, while a stored XSS 
does not provide instant feedback. You will need to log into the admin area and look through 
the CMS in order to "spring the trap" and find out if your attack succeeded. Determine which 
color has the vulnerability. Use your name in the XSS so that your results won't be confused 
with anyone else's (example: <script>alert('Mallory found the XSS!');</script>).
```

<img
src='https://github.com/RobPiccirillo/Week-8-Pentesting-Live-Targets/blob/master/GreenXSS.gif'
title='Video Walkthrough' width='' alt='Video Walkthrough' />

* Users can insert an XSS through the "Feedback" section of the "Contact" page, which is then activated when admins attempt to open the feedback tab to view user feedback.




## Red

Vulnerability #1: **Insecure Direct Object Reference**

```
2. Insecure Direct Object Reference: One of the three sites is missing code which would prevent 
some sensitive information from being made public. Determine which color has the vulnerability. 
Then, figure out what the other two sites did correctly to prevent the information leak.
```

<img
src='https://github.com/RobPiccirillo/Week-8-Pentesting-Live-Targets/blob/master/RedIDOR.gif'
title='Video Walkthrough' width='' alt='Video Walkthrough' />

* The salesperson database can be accessed via modifying the "?id=" tag in the url. By doing so you can access salesperson pages that aren't readily "available" to the public, such as salesperson ID's 10 & 11 (public display ends at ID 9).




Vulnerability #2: **Cross-Site Request Forgery**

```
5. Cross-Site Request Forgery: One of the three sites does not have CSRF protections on the admin area. 
A clever attacker could design a form which would automatically submit form data to the staff area 
and take advantage of a logged in user's access permissions. Be the attacker and design a form which 
will make a change to the spelling of some database content. (For example, change the first user from 
"James" to "Jim", or change "Alabama" to "Alabamaaaa".) Then point the form action at each of the three 
sites to find out which color has the vulnerability. Do not neglect to be stealthy with your formâ€”your 
unsuspecting, logged-in admin should neither see the form nor the results of the form submission.
```

<img
src='https://github.com/RobPiccirillo/Week-8-Pentesting-Live-Targets/blob/master/RedCrossSiteForgeryRequest.gif'
title='Video Walkthrough' width='' alt='Video Walkthrough' />

* The site accepts a post request from a different source that could have a hidden form in it, which can access and make alterations to the databases on the site.


## Notes

Describe any challenges encountered while doing the work
